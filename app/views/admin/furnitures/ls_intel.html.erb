<% klass_counter = 0 %>
<% value_counter = 0 %>
<% next_klass = Proc.new { klass_counter += 1; "kid=#{klass_counter}"  }%>
<% next_value = Proc.new { value_counter += 1; "v#{value_counter}"  }%>

<%= render 'admin/furnitures/ls_intel/shared/build_section' %>

<% if @furniture.has_unconfirmed_data %>
<div class="panel panel-primary">
  <div class="panel-heading">
  	<span class='fa fa-exclamation-triangle'></span> داده‌های تایید نشده!
  </div>
  <div class="panel-body">این محصول شامل داده‌های اطلاعاتی تایید نشده می‌باشد؛ تا زمانی که این اطلاعات تایید نشوند این محصول قابل سفارش از سمت مشتری نمی‌باشد.</div>
</div>
<% end %>
<% user_types = { } %>
<ul class="nav nav-tabs nav-rtl" id="furniture-info" role="tablist">
	<% @intel.keys.each.with_index do |k, index| %>
		<% user_types[k] = Admin::UserType.where(symbol: k.upcase).first %>
	  <li class="<%= index == 0 ? 'active' : '' %>" role="presentation">
	    <a aria-controls="<%= user_types[k].name %>" aria-expanded="false" data-toggle="tab" href="#<%= k.to_s %>-tab-content" id="<%= k.to_s %>-tab" role="tab"><%= user_types[k].name %></a>
	  </li>
  <% end %>
</ul>
<div class="tab-content" id="furniture-info-content">
	<% @intel.keys.each.with_index do |k, index| %>
	  <div aria-labelledby="<%= k.to_s %>-tab" class="tab-pane fade <%= index == 0 ? 'active in' : '' %>" id="<%= k.to_s %>-tab-content" role="tabpanel">
  		<% panel_id = "furniture-intel-panel-#{next_value.call}" %>
			<div class='furniture-intel' id="<%= panel_id %>">
				<%= acu_as :admin { render 'shared/editable_content', for_tag: "##{panel_id}"  }%>
				<%= render "admin/furnitures/ls_intel/#{k.to_s}", intel: @intel[k], next_value: next_value, next_klass: next_klass %>
				<div class='clearfix'></div>
			</div>
			<table class='table'>
				<tbody>
					<tr>
						<td><span class='label label-danger'>رنگ پس‌زمینه‌ی فرمز</span></td>
						<td>داده‌هایی هستند که سیستم با در نظر گرفتن دیگر داده‌ها، <b>«مشکوک» به اشتباه بودن آن‌ها</b> است؛ این بستگی به مدیریت سیستم دارد که این داده‌ها را <b>تایید</b> یا <b>ویرایش</b> نماید.</td>
					</tr>
					<tr>
						<td><span class='label label-warning'>رنگ پس‌زمینه‌ی زرد</span></td>
						<td>داده‌هایی هستند که مدیریت آن‌ها را تغییر داده است.</td>
					</tr>
				</tbody>
			</table>
	  </div>
	<% end %>
</div>

<%= javascript_include_tag 'admin/furniture_confirm_data' %>