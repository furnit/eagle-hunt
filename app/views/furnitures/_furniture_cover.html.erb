<% if @furniture.images.length > 0 %>

  <%= javascript_include_tag 'photoswipe/photoswipe.min.js', 'photoswipe/photoswipe-ui-default.min.js' %>
  <%= stylesheet_link_tag    'photoswipe/photoswipe.css', 'photoswipe/default-skin/default-skin.css', media: 'all' %>

	<div id='furniture-cover'>
		<%= create_cover image_url(@furniture.images), height: '500px', style: 'margin-top:-20px; z-index: -1000; position: absolute; top: 70px' %>
		<!-- <img src='<%= image_url(@furniture.images)%>' style=' display: block; width: 100%; height: 500px; object-fit: cover; position: absolute; z-index: -1000; top: 50px' /> -->		<div id='cover-options'>
			<div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 pull-right" role="toolbar">
				  <%= link_to edit_furniture_path(@furniture), :remote => true, :class => "btn btn-default inline-html-call" do %>
				  	<span class='fa fa-photo'></span> تنظیم پروفایل
			  	<% end %>
			</div>
		</div>
		
		<div class="container text-center">
			<div id='cover-container'>
				<div class='cover-scroller col-lg-1 col-md-1 col-sm-1 col-xs-1' data='left'><span class='fa fa-chevron-left'></span></div>
				<div id='cover-collection' class='col-lg-10 col-md-10 col-sm-10 col-xs-10'>
				<% 1.times do %>
				<% index = 0; @furniture.images.each do |i| %>
						<%= link_to image_url(i), 'data-type' => 'photo-gallary', 'data-thumb' => thumbnail_url(i) do %>
							<%= image_tag thumbnail_url(i), :class => 'cover-item img-responsive img-thumbnail' %>
						<% end %>
					<% end %>
				<% end %>
				</div>
				<div class='cover-scroller col-lg-1 col-md-1 col-sm-1 col-xs-1' data='right'><span class='fa fa-chevron-right'></span></div>
			</div>
		</div>
		<div class='clearfix'></div>
	</div>
	<script type="application/javascript">
		$(document).ready(function(){
			$('#furniture-cover .cover-scroller[data="right"]').addClass('disabled');
			if($('#cover-collection')[0].scrollWidth <= $('#cover-collection').width()) $('.cover-scroller').addClass('disabled');
				
			$('#furniture-cover .cover-scroller[data]').click(function() {
				event.preventDefault();
				if($(this).attr('data') == 'right') {
					$('#cover-collection').animate({scrollLeft: '+=200'}, 'fast');
					if($('#cover-collection')[0].scrollWidth - $('#cover-collection').scrollLeft() - $('#cover-collection').width() <= 221)
						$(this).addClass('disabled');
					$('#furniture-cover .cover-scroller[data="left"]').removeClass('disabled');
				} else if($(this).attr('data') == 'left') {
					$('#cover-collection').animate({scrollLeft: '-=200'}, 'fast');
					if($('#cover-collection').scrollLeft() < 200)
						$(this).addClass('disabled');
					$('#furniture-cover .cover-scroller[data="right"]').removeClass('disabled');
				}
			});
			function openPhotoSwipe(items, options) {
				var pswpElement = document.querySelectorAll('.pswp')[0];
				// Initializes and opens PhotoSwipe
				var gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);
				gallery.init();
			}
			$('#furniture-cover #cover-collection [data-type="photo-gallary"]').click(function(e){
					e.preventDefault();
					e.stopPropagation();
					items = $("#furniture-cover #cover-collection [data-type='photo-gallary']").map(function() { return { src: this.href, msrc: $(this).attr('data-thumb'), w: 1280, h: 720 }; }).get();
					options = {
							index: $('#furniture-cover #cover-collection [data-type="photo-gallary"]').index(this),
							fullscreenEl: true,
							history: false,
					};
					openPhotoSwipe(items, options);
			});
		});
	</script>
	
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
	
<% end %>
